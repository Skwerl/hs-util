<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Test Console</title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<style type="text/css">
	#output {
		font-family: "Courier New", Courier, monospace;
		font-size: 12px;
	}
</style>

</head>

<body>
<div id="everything">
	<form id="form1" name="form1" method="post" action="/cmts/">
		<textarea name="data1" id="data1" cols="100" rows="10">{
    "patient": {
        "identity": "7d2ed041-fa93-472d-97a8-324b8fde982c",
        "firstName": "export",
        "lastName": "patient",
        "ssn": "345-34-1120",
        "address": [
            {
                "name": "Home",
                "address1": "2645 Mulberry Lane",
                "address2": "",
                "city": "Toledo",
                "state": "OH",
                "postalCode": "43605",
                "countryCode": "US",
                "phone": [
                    {
                        "areaCode": "234",
                        "prefix": "837",
                        "suffix": "2345",
                        "type": "OFFICE"
                    }
                ]
            }
        ],
        "phone": null,
        "email": null,
        "dob": "1960-04-22",
        "gender": "M",
        "language": "English",
        "patientConsent": null,
        "maritalStatus": null,
        "race": "A",
        "ethnicity": "H",
        "smoking": 2,
        "paymentProfile": null,
        "emergency": [
            {
                "name": "emergency",
                "phone": {
                    "areaCode": "234",
                    "prefix": "837",
                    "suffix": "2345",
                    "type": "OFFICE"
                }
            }
        ],
        "subscriberIsPatient": null,
        "insurance": null,
        "externalId": "5369509",
        "middleName": "d",
        "suffix": null,
        "preferredContact": null,
        "smokingFrequency": "1 pack/day",
        "ageInYears": 52
    },
    "medication": [
        {
            "drug": {
                "rcopiaId": null,
                "ndcid": "00071015640",
                "brandName": "Lipitor",
                "genericName": null,
                "fullDescription": null,
                "brandType": null,
                "form": "Tablet",
                "strength": null,
                "routeCode": null,
                "rxNormType": null,
                "rxNormId": null,
                "drugGroup": null
            },
            "note": [],
            "patientPrescription": [
                {
                    "prescribe": {
                        "prescribeIdentity": "664a66ec-12d0-4530-80b2-1d03e93ba6bd",
                        "patientIdentity": "7d2ed041-fa93-472d-97a8-324b8fde982c",
                        "patientExternalIdentity": "",
                        "pharmacyIdentity": "",
                        "hasScheduledDrug": false,
                        "stopDate": null,
                        "addToMedicationList": true,
                        "sig": {
                            "drug": {
                                "rcopiaId": null,
                                "ndcid": "00071015640",
                                "brandName": "Lipitor",
                                "genericName": null,
                                "fullDescription": null,
                                "brandType": null,
                                "form": "Tablet",
                                "strength": null,
                                "routeCode": null,
                                "rxNormType": null,
                                "rxNormId": null,
                                "drugGroup": null
                            },
                            "action": "Apply",
                            "dose": "1",
                            "doseUnit": "tablet",
                            "route": "as directed",
                            "doseTiming": "once a day",
                            "doseOther": null,
                            "duration": "7 days",
                            "quantity": "14",
                            "quantityUnits": "tablets",
                            "refills": "2",
                            "substitutionPermitted": true,
                            "otherNotes": "Other Notes",
                            "patientNotes": "Patient Notes",
                            "comments": "Comments",
                            "schedule": null,
                            "writtenDate": null,
                            "effectiveDate": null,
                            "lastFillDate": null,
                            "soldDate": null
                        },
                        "checkId": null,
                        "signaturePassword": "1234",
                        "prescriberOrderNumber": null,
                        "rxReferenceNumber": null,
                        "formularyNote": null,
                        "interactionNote": null,
                        "allergyReaction": null,
                        "interactionReaction": null,
                        "drugInteractionCheckPerformed": false,
                        "icd9": null,
                        "ePrescribe": false,
                        "createdBy": "dc30fc2d-5901-481a-bafe-7b44bfe5fe4d",
                        "createdByFirstName": "chuck",
                        "createdByLastName": "norris"
                    },
                    "createdAt": 1363130900488,
                    "createdBy": "dc30fc2d-5901-481a-bafe-7b44bfe5fe4d",
                    "active": true
                }
            ],
            "active": true,
            "source": "SOCIAL_CARE"
        }
    ],
    "problem": [
        {
            "problemNoteIdentity": "03a00868-0947-4497-bc85-4afb5f3357e8",
            "icd9": {
                "code": "0022",
                "desc": "flu"
            },
            "note": null,
            "problemStartedAt": null,
            "problemStoppedAt": null,
            "soapNoteIdentity": "4dc0029b-76bc-412e-b7d3-6398fcfac4e3",
            "significant": false,
            "active": true,
            "updatedAt": "2013-03-12T23:28:19.633Z",
            "createdBy": "dc30fc2d-5901-481a-bafe-7b44bfe5fe4d"
        },
        {
            "problemNoteIdentity": "78d5c06f-c1ae-4841-ac88-c52429677fc8",
            "icd9": {
                "code": "250.02",
                "desc": "Diabetes Mellitus, Type 2"
            },
            "note": "Low blood sugar",
            "problemStartedAt": "2009-12-24",
            "problemStoppedAt": null,
            "soapNoteIdentity": null,
            "significant": true,
            "active": false,
            "updatedAt": "2013-03-12T23:28:21.208Z",
            "createdBy": "dc30fc2d-5901-481a-bafe-7b44bfe5fe4d"
        },
        {
            "problemNoteIdentity": "5bf226b3-72c8-480a-b24c-3d07b60f0ee3",
            "icd9": {
                "code": "01116",
                "desc": "bronchitis"
            },
            "note": null,
            "problemStartedAt": null,
            "problemStoppedAt": null,
            "soapNoteIdentity": "4dc0029b-76bc-412e-b7d3-6398fcfac4e3",
            "significant": false,
            "active": true,
            "updatedAt": "2013-03-12T23:28:19.633Z",
            "createdBy": "dc30fc2d-5901-481a-bafe-7b44bfe5fe4d"
        }
    ],
    "allergy": [
        {
            "identity": "13e04179-826f-4534-adab-92db2438c44d",
            "name": "Allergy to penicillin",
            "ndcidCode": null,
            "allergyGroupId": null,
            "active": true,
            "allergicReaction": "Rash",
            "allergicReactionDate": "2001-01-01",
            "snomed": "91936005",
            "substance": null,
            "reaction": null,
            "createdAt": "2013-03-12",
            "updatedAt": "2013-03-12"
        }
    ],
    "immunization": [
        {
            "createTime": "2013-03-12T23:28:21.910Z",
            "vaccine": "Influenza",
            "notes": "Administered Flu Shot for patient",
            "userAssertion": "CONFIRMED",
            "activityTime": "2012-11-02",
            "activityBy": "CVS Pharmacy",
            "administeredAmount": "3",
            "administeredUnit": "vials",
            "vaccineLotNumber": "003843",
            "manufacturerName": "Merck",
            "manufacturerCode": "ME-394",
            "cvxCode": "15"
        }
    ],
    "soapNote": [
        {
            "identity": "4dc0029b-76bc-412e-b7d3-6398fcfac4e3",
            "subjective": {
                "chiefComplaint": "Knee pain",
                "note": "motorcycle injury",
                "symptoms": [
                    "grinding",
                    "headache",
                    "ear pain"
                ],
                "historyOfCurrentIllness": "previous surgery",
                "appointmentDate": "2012-01-19"
            },
            "objectiveVitals": {
                "vitalNotes": "getting basic measurements",
                "temperature": 99.1,
                "heightFeet": 5,
                "heightInches": 9,
                "respiratoryRate": 10,
                "weight": 165.3,
                "bpSystolic": 120,
                "bpDiastolic": 80,
                "pulse": 75,
                "headCircumference": 20.7,
                "oxygenSaturation": 82,
                "smoking": 2,
                "painPoints": [
                    {
                        "painLocation": "UPPER SHOULDER",
                        "painLevel": 3
                    }
                ],
                "smokingFrequency": "1 pack/day",
                "bmi": 24.410273
            },
            "objectivePhysical": {
                "physicalNotes": "patient is complaining of back pain and is unable to sleep",
                "problemAreas": [
                    {
                        "bodyPart": {
                            "name": "CHEST",
                            "category": "Inspection"
                        },
                        "notes": "Heartbeat regular",
                        "imageUrl": ""
                    },
                    {
                        "bodyPart": {
                            "name": "NEURO II-XII",
                            "category": "Sensory"
                        },
                        "notes": "No issues",
                        "imageUrl": ""
                    }
                ],
                "patientEducationTopicsDiscussed": [
                    "Asthma",
                    "Injury Prevention"
                ]
            },
            "assessment": {
                "notes": "minor back strain",
                "problems": [
                    {
                        "problemNoteIdentity": null,
                        "icd9": {
                            "code": "0022",
                            "desc": "flu"
                        },
                        "note": null,
                        "problemStartedAt": null,
                        "problemStoppedAt": null,
                        "soapNoteIdentity": "4dc0029b-76bc-412e-b7d3-6398fcfac4e3",
                        "significant": false,
                        "active": true,
                        "updatedAt": null,
                        "createdBy": null
                    },
                    {
                        "problemNoteIdentity": null,
                        "icd9": {
                            "code": "01116",
                            "desc": "bronchitis"
                        },
                        "note": null,
                        "problemStartedAt": null,
                        "problemStoppedAt": null,
                        "soapNoteIdentity": "4dc0029b-76bc-412e-b7d3-6398fcfac4e3",
                        "significant": false,
                        "active": true,
                        "updatedAt": null,
                        "createdBy": null
                    }
                ]
            },
            "plan": {
                "notes": "prescribing some painkillers, follow up in 2 weeks",
                "comments": "prescribing celebrex 300mg, minor sprain that should clear up in 2 weeks"
            },
            "updateBy": "dc30fc2d-5901-481a-bafe-7b44bfe5fe4d",
            "updatedAt": "2013-03-12T23:28:20.133Z",
            "createdBy": "dc30fc2d-5901-481a-bafe-7b44bfe5fe4d",
            "createdAt": "2013-03-12T23:28:17.485Z"
        }
    ],
    "lab": [
        {
            "labOrder": null,
            "labResult": {
                "identity": "95164077-bc6d-4fe8-b098-c47901899816",
                "loincCode": "14471-0",
                "dateLabPerformed": "2013-01-01",
                "labType": "Fasting Blood Glucose",
                "labDescription": "Fasting Blood Glucose",
                "idealRange": "170 mg/dl - 170 mg/dl",
                "labResult": "178 mg/dl",
                "labIdentity": "c9f347ba-8bf0-47e8-8d96-1e735b449137"
            },
            "labIdentity": "c9f347ba-8bf0-47e8-8d96-1e735b449137"
        }
    ],
    "author": "chuck norris",
    "organization": "Health Symmetric"
}</textarea><br/>
		<select name="format" id="format">
			<option value="ccd" selected>CCD</option>
			<option value="adt">ADT</option>
			<option value="oru">ORU</option>
			<option value="vxu">VXU</option>
		</select>
		<input type="submit" name="button" id="button1" value="Serialize JSON" />
	</form>
	<br/>
	<form id="form2" name="form2" method="post" action="/cmts/">
		<textarea name="data2" id="data2" cols="100" rows="10"></textarea><br/>
		<input type="submit" name="button" id="button2" value="Deserialize HL7" />
	</form>
<br><b>Output:</b> <span id="endpoint"></span><br><pre id="output"></pre>
</div>
</div>

<script type="text/javascript">

$(document).ready(function() {
	$("#form1").submit(function() {
		var endpoint = "/cmts/serialize/"+$("#format").val();
		$.post(endpoint, $("#data1").val(), function(data) {
			$("#output").html(data);
			$("#endpoint").html(endpoint);			
		}, "text");
		return false;
	});
	$("#form2").submit(function() {
		var endpoint = "/cmts/deserialize/";
		$.post(endpoint, $("#data2").val(), function(data) {
			$("#output").html(data);
			$("#endpoint").html(endpoint);			
		}, "text");
		return false;
	});
});

</script>

</body>
</html>