<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Test Console</title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

</head>

<body>
<div id="everything">
	<form id="form1" name="form1" method="post" action="/cmts/">
		<textarea name="data1" id="data1" cols="100" rows="10">{
    "patient": {
        "firstName": "Jeremy1",
        "lastName": "ODay2",
        "ssn": "ssn",
        "preferredContact": null,
        "phone": [{
            "areaCode": "123",
            "prefix": "456",
            "suffix": "7890",
            "type": "OFFICE"
        }, {
            "areaCode": "123",
            "prefix": "456",
            "suffix": "7890",
            "type": "FAX"
        }],
        "address": [{
            "name": "address name",
            "address1": "address1",
            "address2": "address2",
            "city": "city",
            "state": "state",
            "postalCode": "90403",
            "countryCode": "US"
        }, {
            "name": "address name",
            "address1": "address1",
            "address2": "address2",
            "city": "city",
            "state": "state",
            "postalCode": "90403",
            "countryCode": "US"
        }],
        "email": [{
            "emailAddress": "jeremy@chaoslabs.com",
            "primary": true
        }],
        "dob": "2012-11-30T21:07:49.005Z",
        "gender": "M",
        "language": "language",
        "patientConsent": false,
        "maritalStatus": "D",
        "race": "R",
        "ethnicity": "E",
        "smoking": "1",
        "paymentProfile": "A",
        "emergency": [{
            "name": "Name",
            "phone": {
                "areaCode": "123",
                "prefix": "456",
                "suffix": "7890",
                "type": "OFFICE"
            }
        }, {
            "name": "Name",
            "phone": {
                "areaCode": "123",
                "prefix": "456",
                "suffix": "7890",
                "type": "OFFICE"
            }
        }],
        "subscriberIsPatient": true,
        "insurance": [{
            "name": "Insurance Name",
            "copayPennies": 500,
            "primary": false,
            "idNumber": "123456",
            "carrierPayerId": "987654"
        }, {
            "name": "Insurance Name",
            "copayPennies": 500,
            "primary": false,
            "idNumber": "123456",
            "carrierPayerId": "987654"
        }],
        "externalId": "99927557",
        "middleName": null,
        "suffix": null,
        "smokingFrequency": "1-9 cigarettes/day"
    },
    "author": "Author",
    "organization": "Organization",
    "problem": [{
        "problemNoteIdentity": null,
        "icd9": {
            "code": "290.0.2",
            "desc": "Senile dementia, uncomplicated"
        },
        "note": "hallucinations",
        "problemStartedAt": "2012-12-24T08:58:52.186-08:00",
        "problemStoppedAt": null,
        "createdAt": 1356368332328,
        "createdBy": null,
        "soapNoteIdentity": null,
        "status": "new",
        "significant": true
    }],
    "medication": [{
        "active": true,
        "00069421030": {
            "drug": {
                "rcopiaId": null,
                "ndcid": "00069421030",
                "brandName": "Viagra",
                "genericName": null,
                "fullDescription": null,
                "brandType": null,
                "form": "Tablet",
                "strength": null,
                "routeCode": null,
                "rxNormType": null,
                "rxNormId": null
            },
            "note": [],
            "patientPrescription": [{
                "active": true,
                "prescribe": {
                    "prescribeIdentity": "aa1cc96a-6333-4d84-8eb6-50f295d9e8ee",
                    "patientIdentity": "2f6154dc-f7a2-42e9-8c79-d18001d94d69",
                    "patientExternalIdentity": "5288541",
                    "pharmacyIdentity": "9900004",
                    "hasScheduledDrug": false,
                    "stopDate": null,
                    "addToMedicationList": true,
                    "sig": {
                        "drug": {
                            "rcopiaId": null,
                            "ndcid": "00069421030",
                            "brandName": "Viagra",
                            "genericName": null,
                            "fullDescription": null,
                            "brandType": null,
                            "form": "Tablet",
                            "strength": null,
                            "routeCode": null,
                            "rxNormType": null,
                            "rxNormId": null
                        },
                        "action": null,
                        "dose": null,
                        "doseUnit": null,
                        "route": null,
                        "doseTiming": null,
                        "doseOther": null,
                        "duration": null,
                        "quantity": "14",
                        "quantityUnits": "tablets",
                        "refills": null,
                        "substitutionPermitted": true,
                        "otherNotes": "Other notes",
                        "patientNotes": "Patient notes",
                        "comments": "Comments",
                        "schedule": null,
                        "writtenDate": null,
                        "effectiveDate": null,
                        "lastFillDate": null,
                        "soldDate": null
                    },
                    "checkId": null,
                    "signaturePassword": "1234",
                    "prescriberOrderNumber": null,
                    "rxReferenceNumber": null,
                    "formularyNote": null,
                    "interactionNote": null,
                    "allergyReaction": null,
                    "interactionReaction": null,
                    "drugInteractionCheckPerformed": false
                },
                "createdAt": 1360125449195,
                "createdBy": "c8ccd370-322f-43db-9165-8fc21812448a"
            }, {
                "prescribe": {
                    "prescribeIdentity": "d31f2a56-b3d7-4a07-9519-d641a55d3c07",
                    "patientIdentity": "2f6154dc-f7a2-42e9-8c79-d18001d94d69",
                    "patientExternalIdentity": "5288541",
                    "pharmacyIdentity": "9900004",
                    "hasScheduledDrug": false,
                    "stopDate": null,
                    "addToMedicationList": true,
                    "sig": {
                        "drug": {
                            "rcopiaId": null,
                            "ndcid": "00069421030",
                            "brandName": "Viagra",
                            "genericName": null,
                            "fullDescription": null,
                            "brandType": null,
                            "form": "Tablet",
                            "strength": null,
                            "routeCode": null,
                            "rxNormType": null,
                            "rxNormId": null
                        },
                        "action": null,
                        "dose": null,
                        "doseUnit": null,
                        "route": null,
                        "doseTiming": null,
                        "doseOther": null,
                        "duration": null,
                        "quantity": "14",
                        "quantityUnits": "tablets",
                        "refills": null,
                        "substitutionPermitted": true,
                        "otherNotes": "Other notes",
                        "patientNotes": "Patient notes",
                        "comments": "Comments",
                        "schedule": null,
                        "writtenDate": null,
                        "effectiveDate": null,
                        "lastFillDate": null,
                        "soldDate": null
                    },
                    "checkId": null,
                    "signaturePassword": "1234",
                    "prescriberOrderNumber": null,
                    "rxReferenceNumber": null,
                    "formularyNote": null,
                    "interactionNote": null,
                    "allergyReaction": null,
                    "interactionReaction": null,
                    "drugInteractionCheckPerformed": false
                },
                "createdAt": 1360125458877,
                "createdBy": "c8ccd370-322f-43db-9165-8fc21812448a"
            }]
        }
    }],
    "allergy": [{
        "identity": null,
        "name": "peanut",
        "ndcidCode": "Arachis hypogaea",
        "allergyGroupId": "Arachis Ara h 1",
        "allergicReaction": "Anaphylaxis",
        "allergicReactionDate": "2013-01-15T10:39:20.546-08:00",
        "active": true
    }],
    "soapNote": [{
        "identity": "27598610-397c-456b-a8a0-f394bd704414",
        "subjective": {
            "chiefComplaint": "Knee pain",
            "note": "motorcycle injury",
            "symptoms": [
                "sensative",
                "swelling",
                "discoloration"],
            "historyOfCurrentIllness": "previous surgery",
            "appointmentDate": "2013-01-16T05:45:08.459-08:00"
        },
        "objectiveVitals": {
            "vitalNotes": "sample vitals notes",
            "temperature": 98.6,
            "heightFeet": 5,
            "heightInches": 8,
            "respiratoryRate": 16,
            "weight": 175,
            "bpSystolic": 120,
            "bpDiastolic": 80,
            "pulse": 75,
            "headCircumference": 22.5,
            "oxygenSaturation": 82,
            "smoking": 1,
            "painPoints": [{
                "painLocation": "Knee",
                "painLevel": 3
            }],
            "bmi": 26.61
        },
        "objectivePhysical": {
            "physicalNotes": "patient is complaining of knee pain",
            "problemAreas": [{
                "bodyPart": {
                    "name": "KNEE",
                    "category": "leg"
                },
                "notes": "throbbing pain",
                "imageUrl": "http://xxx/yyy"
            }, {
                "bodyPart": {
                    "name": "HEENT",
                    "category": "Mouth"
                },
                "notes": "Redness in Throat",
                "imageUrl": null
            }],
            "patientEducationTopicsDiscussed": null
        },
        "assessment": {
            "notes": "Update to Serious problems here",
            "problems": [{
                "problemNoteIdentity": null,
                "icd9": {
                    "code": "321",
                    "desc": "Cough"
                },
                "note": "some notes",
                "problemStartedAt": null,
                "problemStoppedAt": null,
                "soapNoteIdentity": null,
                "significant": false,
                "status": null,
                "updatedAt": null,
                "createdBy": null
            }, {
                "problemNoteIdentity": null,
                "icd9": {
                    "code": "543.2",
                    "desc": "id Pulvinar"
                },
                "note": "some more notes",
                "problemStartedAt": null,
                "problemStoppedAt": null,
                "soapNoteIdentity": null,
                "significant": false,
                "status": "open",
                "updatedAt": null,
                "createdBy": null
            }]
        },
        "plan": {
            "notes": "Physical Therapy 2x a week",
            "comments": "Follow up visit"
        },
        "updateBy": "Mieke Mocke",
        "updatedAt": "2013-01-03T15:49:35.346-08:00"
    }],
    "lab": [{
        "identity": "219be44e-43f1-4808-8c3a-4dc51a3f7532",
        "loincCode": "1003-3",
        "dateLabPerformed": "2013-01-01",
        "labType": "Blood Test",
        "labDescription": "Indirect antiglobulin test.complement specific reagent",
        "idealRange": "True/False",
        "labResult": "False",
        "labIdentity": "febf1a86-03b3-4982-b56d-3f570bf43edc"
    }],
    "immunization": [{
        "createTime": "2013-03-01T05:58:12.785Z",
        "vaccine": "Influenza",
        "notes": "Administered Flu Shot for patient",
        "userAssertion": "CONFIRMED",
        "activityTime": "2012-11-02",
        "activityBy": "CVS Pharmacy",
        "administeredAmount": "3",
        "administeredUnit": "vials",
        "vaccineLotNumber": "003843",
        "manufacturerName": "Merck",
        "manufacturerCode": "ME-394",
        "cvxCode": "15"
    }]
}</textarea><br/>
		<select name="format" id="format">
			<option value="ccd" selected>CCD</option>
			<option value="adt">ADT</option>
			<option value="oru">ORU</option>
			<option value="vxu">VXU</option>
		</select>
		<input type="submit" name="button" id="button1" value="Serialize JSON" />
	</form>
	<br/>
	<form id="form2" name="form2" method="post" action="/cmts/">
		<textarea name="data2" id="data2" cols="100" rows="10"></textarea><br/>
		<input type="submit" name="button" id="button2" value="Deserialize HL7" />
	</form>
<br><b>Output:</b> <span id="endpoint"></span><br><pre id="output"></pre>
</div>
</div>

<script type="text/javascript">

$(document).ready(function() {
	$("#form1").submit(function() {
		var endpoint = "/cmts/serialize/"+$("#format").val();
		$.post(endpoint, $("#data1").val(), function(data) {
			$("#output").html(data);
			$("#endpoint").html(endpoint);			
		}, "text");
		return false;
	});
	$("#form2").submit(function() {
		var endpoint = "/cmts/deserialize/";
		$.post(endpoint, $("#data2").val(), function(data) {
			$("#output").html(data);
			$("#endpoint").html(endpoint);			
		}, "text");
		return false;
	});
});

</script>

</body>
</html>